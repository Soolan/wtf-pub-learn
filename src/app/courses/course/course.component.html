<div [fxFlex.gt-lg]="isDashboard?100:65" [fxFlex.lg]="isDashboard?100:85" fxFlex.lt-lg="100" fxLayout="row wrap"
     fxLayoutAlign="space-between start"
     class="content" [style.margin]="isDashboard ? '0':'var(--space-xl) auto'">
  <div class="course" fxFlex="55" fxFlex.lt-md="100" fxLayout="row wrap" fxLayoutAlign="space-between start">
    <div class="progress" *ngIf="loading.course">
      <mat-progress-spinner mode="indeterminate" color="primary"></mat-progress-spinner>
    </div>
    <div *ngIf="course" fxFlex="100" fxLayout="row wrap" fxLayoutAlign="space-around center">
      <div fxFlex="100" class="image" *ngIf="course.banner"
           [ngStyle]="{'background-image': 'url('+(course.banner|storageUrl|async)+')'}"></div>
      <div fxFlexOffset="90" fxFlex="10">
        <div class="avatar" [ngStyle]="{'background-image': 'url(' + (course.avatar | storageUrl | async) + ')'}"></div>
      </div>
      <div *ngIf="isDashboard;else guest_view" fxFlex="95" class="heading mat-title"
           ngClass.lt-md="mat-subheading-2" [ngStyle]="{'margin-top': '-2em' }">{{course.name}}</div>
      <ng-template #guest_view>
        <div fxFlex="95" class="heading" [ngStyle]="{'margin-top': '-1.2em' }"
             ngClass.gt-md="mat-display-1" ngClass.md="mat-headline" ngClass.lt-md="mat-title">
          <span *ngIf="keyword; else no_keyword" appBlackRenderer #content [content]="course.name"
                [keyword]="keyword"></span>
          <ng-template #no_keyword>
            {{course.name}}
          </ng-template>
        </div>
      </ng-template>
      <div fxFlex="95" class="mat-body-2 description">{{course.description}}</div>
    </div>
  </div>
  <div class="lessons" fxFlex="42" fxFlex.lt-md="90" fxFlexOffset.lt-md="5" fxLayout="row wrap"
       fxLayoutAlign="space-between start">
    <div fxFlex="100" *ngIf="loading.lessons">
      <mat-progress-bar color="primary" mode="query"></mat-progress-bar>
    </div>
    <!--    <app-progress fxFlex="100" fxLayout="row wrap" fxLayoutAlign="space-between start" [courseId]="course.id"></app-progress>-->
    <div fxFlex="100" fxLayout="row wrap" fxLayoutAlign="space-between start" class="lesson"
         *ngFor="let lesson of lessons" (click)="open(lesson.id)">
      <div fxFlex="70" fxLayout="row wrap" fxLayoutAlign="space-between start">
        <div fxFlex class="avatar"
             [ngStyle]="{'background-image': 'url(' + (course.avatar|storageUrl|async) + ')'}"></div>
        <div fxFlex="90" class="name mat-subheading-2">{{lesson.name}}</div>
        <div fxFlex="100" class="description mat-body-2">{{lesson.description}}</div>
      </div>
      <div fxFlex="29" *ngIf="!progress; else status_check">
        <button mat-flat-button>Start</button>
      </div>
      <ng-template #status_check>
        <ng-container [ngSwitch]="progress.status">
          <div fxFlex="29" *ngSwitchCase="status.Start" class="mat-caption done">
            <button mat-flat-button>{{statuses[status.Start]}}</button>
          </div>
          <div fxFlex="29" *ngSwitchCase="status.Retake" class="mat-caption done">
            <button mat-flat-button>{{statuses[status.Retake]}}</button>
            <mat-icon>done</mat-icon>
          </div>
          <div fxFlex="29" *ngSwitchCase="status.Resume" class="mat-caption done">
          <span *ngFor="let square of [].constructor(getTotalSlides(lesson.id)); let i = index" class="marker"
                [style.background-color]="i <= getCurrentSlide(lesson.id) ? 'var(--color-primary)' : ''">
          </span>
            <button mat-flat-button>{{statuses[status.Resume]}}</button>
          </div>
        </ng-container>
      </ng-template>
    </div>
    <div class="summary" fxFlex="100" fxLayout="row wrap" fxLayoutAlign="space-between start"></div>
  </div>
</div>
